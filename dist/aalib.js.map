{"version":3,"file":"aalib.js","mappings":"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","sources":["webpack://aalib/webpack/universalModuleDefinition","webpack://aalib/./node_modules/rxjs/Observable.js","webpack://aalib/./node_modules/rxjs/Observer.js","webpack://aalib/./node_modules/rxjs/Subscriber.js","webpack://aalib/./node_modules/rxjs/Subscription.js","webpack://aalib/./node_modules/rxjs/add/operator/do.js","webpack://aalib/./node_modules/rxjs/add/operator/map.js","webpack://aalib/./node_modules/rxjs/operator/do.js","webpack://aalib/./node_modules/rxjs/operator/map.js","webpack://aalib/./node_modules/rxjs/symbol/observable.js","webpack://aalib/./node_modules/rxjs/symbol/rxSubscriber.js","webpack://aalib/./node_modules/rxjs/util/UnsubscriptionError.js","webpack://aalib/./node_modules/rxjs/util/errorObject.js","webpack://aalib/./node_modules/rxjs/util/isArray.js","webpack://aalib/./node_modules/rxjs/util/isFunction.js","webpack://aalib/./node_modules/rxjs/util/isObject.js","webpack://aalib/./node_modules/rxjs/util/root.js","webpack://aalib/./node_modules/rxjs/util/toSubscriber.js","webpack://aalib/./node_modules/rxjs/util/tryCatch.js","webpack://aalib/webpack/bootstrap","webpack://aalib/webpack/runtime/define property getters","webpack://aalib/webpack/runtime/global","webpack://aalib/webpack/runtime/hasOwnProperty shorthand","webpack://aalib/webpack/runtime/make namespace object","webpack://aalib/./src/readers/AbstractReader.js","webpack://aalib/./src/utils.js","webpack://aalib/./src/core/rgbProcessor.js","webpack://aalib/./src/core/AAImage.js","webpack://aalib/./src/readers/ImageReader.js","webpack://aalib/./src/readers/VideoReader.js","webpack://aalib/./src/readers/ImageDataReader.js","webpack://aalib/./src/filters/linear.js","webpack://aalib/./src/aafont.js","webpack://aalib/./src/renderers/BaseRenderer.js","webpack://aalib/./src/renderers/HTMLRenderer.js","webpack://aalib/./src/renderers/CanvasRenderer.js","webpack://aalib/./src/core/monoProcessor.js","webpack://aalib/./src/aa.js","webpack://aalib/./src/index.js","webpack://aalib/./src/filters/brightness.js","webpack://aalib/./src/filters/contrast.js","webpack://aalib/./src/filters/inverse.js","webpack://aalib/./src/filters/desaturate.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"aalib\"] = factory();\n\telse\n\t\troot[\"aalib\"] = factory();\n})(self, () => {\nreturn ","\"use strict\";\nvar root_1 = require('./util/root');\nvar toSubscriber_1 = require('./util/toSubscriber');\nvar observable_1 = require('./symbol/observable');\n/**\n * A representation of any set of values over any amount of time. This is the most basic building block\n * of RxJS.\n *\n * @class Observable<T>\n */\nvar Observable = (function () {\n    /**\n     * @constructor\n     * @param {Function} subscribe the function that is called when the Observable is\n     * initially subscribed to. This function is given a Subscriber, to which new values\n     * can be `next`ed, or an `error` method can be called to raise an error, or\n     * `complete` can be called to notify of a successful completion.\n     */\n    function Observable(subscribe) {\n        this._isScalar = false;\n        if (subscribe) {\n            this._subscribe = subscribe;\n        }\n    }\n    /**\n     * Creates a new Observable, with this Observable as the source, and the passed\n     * operator defined as the new observable's operator.\n     * @method lift\n     * @param {Operator} operator the operator defining the operation to take on the observable\n     * @return {Observable} a new observable with the Operator applied\n     */\n    Observable.prototype.lift = function (operator) {\n        var observable = new Observable();\n        observable.source = this;\n        observable.operator = operator;\n        return observable;\n    };\n    /**\n     * Invokes an execution of an Observable and registers Observer handlers for notifications it will emit.\n     *\n     * <span class=\"informal\">Use it when you have all these Observables, but still nothing is happening.</span>\n     *\n     * `subscribe` is not a regular operator, but a method that calls Observable's internal `subscribe` function. It\n     * might be for example a function that you passed to a {@link create} static factory, but most of the time it is\n     * a library implementation, which defines what and when will be emitted by an Observable. This means that calling\n     * `subscribe` is actually the moment when Observable starts its work, not when it is created, as it is often\n     * thought.\n     *\n     * Apart from starting the execution of an Observable, this method allows you to listen for values\n     * that an Observable emits, as well as for when it completes or errors. You can achieve this in two\n     * following ways.\n     *\n     * The first way is creating an object that implements {@link Observer} interface. It should have methods\n     * defined by that interface, but note that it should be just a regular JavaScript object, which you can create\n     * yourself in any way you want (ES6 class, classic function constructor, object literal etc.). In particular do\n     * not attempt to use any RxJS implementation details to create Observers - you don't need them. Remember also\n     * that your object does not have to implement all methods. If you find yourself creating a method that doesn't\n     * do anything, you can simply omit it. Note however, that if `error` method is not provided, all errors will\n     * be left uncaught.\n     *\n     * The second way is to give up on Observer object altogether and simply provide callback functions in place of its methods.\n     * This means you can provide three functions as arguments to `subscribe`, where first function is equivalent\n     * of a `next` method, second of an `error` method and third of a `complete` method. Just as in case of Observer,\n     * if you do not need to listen for something, you can omit a function, preferably by passing `undefined` or `null`,\n     * since `subscribe` recognizes these functions by where they were placed in function call. When it comes\n     * to `error` function, just as before, if not provided, errors emitted by an Observable will be thrown.\n     *\n     * Whatever style of calling `subscribe` you use, in both cases it returns a Subscription object.\n     * This object allows you to call `unsubscribe` on it, which in turn will stop work that an Observable does and will clean\n     * up all resources that an Observable used. Note that cancelling a subscription will not call `complete` callback\n     * provided to `subscribe` function, which is reserved for a regular completion signal that comes from an Observable.\n     *\n     * Remember that callbacks provided to `subscribe` are not guaranteed to be called asynchronously.\n     * It is an Observable itself that decides when these functions will be called. For example {@link of}\n     * by default emits all its values synchronously. Always check documentation for how given Observable\n     * will behave when subscribed and if its default behavior can be modified with a {@link Scheduler}.\n     *\n     * @example <caption>Subscribe with an Observer</caption>\n     * const sumObserver = {\n     *   sum: 0,\n     *   next(value) {\n     *     console.log('Adding: ' + value);\n     *     this.sum = this.sum + value;\n     *   },\n     *   error() { // We actually could just remove this method,\n     *   },        // since we do not really care about errors right now.\n     *   complete() {\n     *     console.log('Sum equals: ' + this.sum);\n     *   }\n     * };\n     *\n     * Rx.Observable.of(1, 2, 3) // Synchronously emits 1, 2, 3 and then completes.\n     * .subscribe(sumObserver);\n     *\n     * // Logs:\n     * // \"Adding: 1\"\n     * // \"Adding: 2\"\n     * // \"Adding: 3\"\n     * // \"Sum equals: 6\"\n     *\n     *\n     * @example <caption>Subscribe with functions</caption>\n     * let sum = 0;\n     *\n     * Rx.Observable.of(1, 2, 3)\n     * .subscribe(\n     *   function(value) {\n     *     console.log('Adding: ' + value);\n     *     sum = sum + value;\n     *   },\n     *   undefined,\n     *   function() {\n     *     console.log('Sum equals: ' + sum);\n     *   }\n     * );\n     *\n     * // Logs:\n     * // \"Adding: 1\"\n     * // \"Adding: 2\"\n     * // \"Adding: 3\"\n     * // \"Sum equals: 6\"\n     *\n     *\n     * @example <caption>Cancel a subscription</caption>\n     * const subscription = Rx.Observable.interval(1000).subscribe(\n     *   num => console.log(num),\n     *   undefined,\n     *   () => console.log('completed!') // Will not be called, even\n     * );                                // when cancelling subscription\n     *\n     *\n     * setTimeout(() => {\n     *   subscription.unsubscribe();\n     *   console.log('unsubscribed!');\n     * }, 2500);\n     *\n     * // Logs:\n     * // 0 after 1s\n     * // 1 after 2s\n     * // \"unsubscribed!\" after 2.5s\n     *\n     *\n     * @param {Observer|Function} observerOrNext (optional) Either an observer with methods to be called,\n     *  or the first of three possible handlers, which is the handler for each value emitted from the subscribed\n     *  Observable.\n     * @param {Function} error (optional) A handler for a terminal event resulting from an error. If no error handler is provided,\n     *  the error will be thrown as unhandled.\n     * @param {Function} complete (optional) A handler for a terminal event resulting from successful completion.\n     * @return {ISubscription} a subscription reference to the registered handlers\n     * @method subscribe\n     */\n    Observable.prototype.subscribe = function (observerOrNext, error, complete) {\n        var operator = this.operator;\n        var sink = toSubscriber_1.toSubscriber(observerOrNext, error, complete);\n        if (operator) {\n            operator.call(sink, this.source);\n        }\n        else {\n            sink.add(this.source ? this._subscribe(sink) : this._trySubscribe(sink));\n        }\n        if (sink.syncErrorThrowable) {\n            sink.syncErrorThrowable = false;\n            if (sink.syncErrorThrown) {\n                throw sink.syncErrorValue;\n            }\n        }\n        return sink;\n    };\n    Observable.prototype._trySubscribe = function (sink) {\n        try {\n            return this._subscribe(sink);\n        }\n        catch (err) {\n            sink.syncErrorThrown = true;\n            sink.syncErrorValue = err;\n            sink.error(err);\n        }\n    };\n    /**\n     * @method forEach\n     * @param {Function} next a handler for each value emitted by the observable\n     * @param {PromiseConstructor} [PromiseCtor] a constructor function used to instantiate the Promise\n     * @return {Promise} a promise that either resolves on observable completion or\n     *  rejects with the handled error\n     */\n    Observable.prototype.forEach = function (next, PromiseCtor) {\n        var _this = this;\n        if (!PromiseCtor) {\n            if (root_1.root.Rx && root_1.root.Rx.config && root_1.root.Rx.config.Promise) {\n                PromiseCtor = root_1.root.Rx.config.Promise;\n            }\n            else if (root_1.root.Promise) {\n                PromiseCtor = root_1.root.Promise;\n            }\n        }\n        if (!PromiseCtor) {\n            throw new Error('no Promise impl found');\n        }\n        return new PromiseCtor(function (resolve, reject) {\n            // Must be declared in a separate statement to avoid a RefernceError when\n            // accessing subscription below in the closure due to Temporal Dead Zone.\n            var subscription;\n            subscription = _this.subscribe(function (value) {\n                if (subscription) {\n                    // if there is a subscription, then we can surmise\n                    // the next handling is asynchronous. Any errors thrown\n                    // need to be rejected explicitly and unsubscribe must be\n                    // called manually\n                    try {\n                        next(value);\n                    }\n                    catch (err) {\n                        reject(err);\n                        subscription.unsubscribe();\n                    }\n                }\n                else {\n                    // if there is NO subscription, then we're getting a nexted\n                    // value synchronously during subscription. We can just call it.\n                    // If it errors, Observable's `subscribe` will ensure the\n                    // unsubscription logic is called, then synchronously rethrow the error.\n                    // After that, Promise will trap the error and send it\n                    // down the rejection path.\n                    next(value);\n                }\n            }, reject, resolve);\n        });\n    };\n    Observable.prototype._subscribe = function (subscriber) {\n        return this.source.subscribe(subscriber);\n    };\n    /**\n     * An interop point defined by the es7-observable spec https://github.com/zenparsing/es-observable\n     * @method Symbol.observable\n     * @return {Observable} this instance of the observable\n     */\n    Observable.prototype[observable_1.observable] = function () {\n        return this;\n    };\n    // HACK: Since TypeScript inherits static properties too, we have to\n    // fight against TypeScript here so Subject can have a different static create signature\n    /**\n     * Creates a new cold Observable by calling the Observable constructor\n     * @static true\n     * @owner Observable\n     * @method create\n     * @param {Function} subscribe? the subscriber function to be passed to the Observable constructor\n     * @return {Observable} a new cold observable\n     */\n    Observable.create = function (subscribe) {\n        return new Observable(subscribe);\n    };\n    return Observable;\n}());\nexports.Observable = Observable;\n//# sourceMappingURL=Observable.js.map","\"use strict\";\nexports.empty = {\n    closed: true,\n    next: function (value) { },\n    error: function (err) { throw err; },\n    complete: function () { }\n};\n//# sourceMappingURL=Observer.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar isFunction_1 = require('./util/isFunction');\nvar Subscription_1 = require('./Subscription');\nvar Observer_1 = require('./Observer');\nvar rxSubscriber_1 = require('./symbol/rxSubscriber');\n/**\n * Implements the {@link Observer} interface and extends the\n * {@link Subscription} class. While the {@link Observer} is the public API for\n * consuming the values of an {@link Observable}, all Observers get converted to\n * a Subscriber, in order to provide Subscription-like capabilities such as\n * `unsubscribe`. Subscriber is a common type in RxJS, and crucial for\n * implementing operators, but it is rarely used as a public API.\n *\n * @class Subscriber<T>\n */\nvar Subscriber = (function (_super) {\n    __extends(Subscriber, _super);\n    /**\n     * @param {Observer|function(value: T): void} [destinationOrNext] A partially\n     * defined Observer or a `next` callback function.\n     * @param {function(e: ?any): void} [error] The `error` callback of an\n     * Observer.\n     * @param {function(): void} [complete] The `complete` callback of an\n     * Observer.\n     */\n    function Subscriber(destinationOrNext, error, complete) {\n        _super.call(this);\n        this.syncErrorValue = null;\n        this.syncErrorThrown = false;\n        this.syncErrorThrowable = false;\n        this.isStopped = false;\n        switch (arguments.length) {\n            case 0:\n                this.destination = Observer_1.empty;\n                break;\n            case 1:\n                if (!destinationOrNext) {\n                    this.destination = Observer_1.empty;\n                    break;\n                }\n                if (typeof destinationOrNext === 'object') {\n                    if (destinationOrNext instanceof Subscriber) {\n                        this.destination = destinationOrNext;\n                        this.destination.add(this);\n                    }\n                    else {\n                        this.syncErrorThrowable = true;\n                        this.destination = new SafeSubscriber(this, destinationOrNext);\n                    }\n                    break;\n                }\n            default:\n                this.syncErrorThrowable = true;\n                this.destination = new SafeSubscriber(this, destinationOrNext, error, complete);\n                break;\n        }\n    }\n    Subscriber.prototype[rxSubscriber_1.rxSubscriber] = function () { return this; };\n    /**\n     * A static factory for a Subscriber, given a (potentially partial) definition\n     * of an Observer.\n     * @param {function(x: ?T): void} [next] The `next` callback of an Observer.\n     * @param {function(e: ?any): void} [error] The `error` callback of an\n     * Observer.\n     * @param {function(): void} [complete] The `complete` callback of an\n     * Observer.\n     * @return {Subscriber<T>} A Subscriber wrapping the (partially defined)\n     * Observer represented by the given arguments.\n     */\n    Subscriber.create = function (next, error, complete) {\n        var subscriber = new Subscriber(next, error, complete);\n        subscriber.syncErrorThrowable = false;\n        return subscriber;\n    };\n    /**\n     * The {@link Observer} callback to receive notifications of type `next` from\n     * the Observable, with a value. The Observable may call this method 0 or more\n     * times.\n     * @param {T} [value] The `next` value.\n     * @return {void}\n     */\n    Subscriber.prototype.next = function (value) {\n        if (!this.isStopped) {\n            this._next(value);\n        }\n    };\n    /**\n     * The {@link Observer} callback to receive notifications of type `error` from\n     * the Observable, with an attached {@link Error}. Notifies the Observer that\n     * the Observable has experienced an error condition.\n     * @param {any} [err] The `error` exception.\n     * @return {void}\n     */\n    Subscriber.prototype.error = function (err) {\n        if (!this.isStopped) {\n            this.isStopped = true;\n            this._error(err);\n        }\n    };\n    /**\n     * The {@link Observer} callback to receive a valueless notification of type\n     * `complete` from the Observable. Notifies the Observer that the Observable\n     * has finished sending push-based notifications.\n     * @return {void}\n     */\n    Subscriber.prototype.complete = function () {\n        if (!this.isStopped) {\n            this.isStopped = true;\n            this._complete();\n        }\n    };\n    Subscriber.prototype.unsubscribe = function () {\n        if (this.closed) {\n            return;\n        }\n        this.isStopped = true;\n        _super.prototype.unsubscribe.call(this);\n    };\n    Subscriber.prototype._next = function (value) {\n        this.destination.next(value);\n    };\n    Subscriber.prototype._error = function (err) {\n        this.destination.error(err);\n        this.unsubscribe();\n    };\n    Subscriber.prototype._complete = function () {\n        this.destination.complete();\n        this.unsubscribe();\n    };\n    Subscriber.prototype._unsubscribeAndRecycle = function () {\n        var _a = this, _parent = _a._parent, _parents = _a._parents;\n        this._parent = null;\n        this._parents = null;\n        this.unsubscribe();\n        this.closed = false;\n        this.isStopped = false;\n        this._parent = _parent;\n        this._parents = _parents;\n        return this;\n    };\n    return Subscriber;\n}(Subscription_1.Subscription));\nexports.Subscriber = Subscriber;\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nvar SafeSubscriber = (function (_super) {\n    __extends(SafeSubscriber, _super);\n    function SafeSubscriber(_parentSubscriber, observerOrNext, error, complete) {\n        _super.call(this);\n        this._parentSubscriber = _parentSubscriber;\n        var next;\n        var context = this;\n        if (isFunction_1.isFunction(observerOrNext)) {\n            next = observerOrNext;\n        }\n        else if (observerOrNext) {\n            next = observerOrNext.next;\n            error = observerOrNext.error;\n            complete = observerOrNext.complete;\n            if (observerOrNext !== Observer_1.empty) {\n                context = Object.create(observerOrNext);\n                if (isFunction_1.isFunction(context.unsubscribe)) {\n                    this.add(context.unsubscribe.bind(context));\n                }\n                context.unsubscribe = this.unsubscribe.bind(this);\n            }\n        }\n        this._context = context;\n        this._next = next;\n        this._error = error;\n        this._complete = complete;\n    }\n    SafeSubscriber.prototype.next = function (value) {\n        if (!this.isStopped && this._next) {\n            var _parentSubscriber = this._parentSubscriber;\n            if (!_parentSubscriber.syncErrorThrowable) {\n                this.__tryOrUnsub(this._next, value);\n            }\n            else if (this.__tryOrSetError(_parentSubscriber, this._next, value)) {\n                this.unsubscribe();\n            }\n        }\n    };\n    SafeSubscriber.prototype.error = function (err) {\n        if (!this.isStopped) {\n            var _parentSubscriber = this._parentSubscriber;\n            if (this._error) {\n                if (!_parentSubscriber.syncErrorThrowable) {\n                    this.__tryOrUnsub(this._error, err);\n                    this.unsubscribe();\n                }\n                else {\n                    this.__tryOrSetError(_parentSubscriber, this._error, err);\n                    this.unsubscribe();\n                }\n            }\n            else if (!_parentSubscriber.syncErrorThrowable) {\n                this.unsubscribe();\n                throw err;\n            }\n            else {\n                _parentSubscriber.syncErrorValue = err;\n                _parentSubscriber.syncErrorThrown = true;\n                this.unsubscribe();\n            }\n        }\n    };\n    SafeSubscriber.prototype.complete = function () {\n        var _this = this;\n        if (!this.isStopped) {\n            var _parentSubscriber = this._parentSubscriber;\n            if (this._complete) {\n                var wrappedComplete = function () { return _this._complete.call(_this._context); };\n                if (!_parentSubscriber.syncErrorThrowable) {\n                    this.__tryOrUnsub(wrappedComplete);\n                    this.unsubscribe();\n                }\n                else {\n                    this.__tryOrSetError(_parentSubscriber, wrappedComplete);\n                    this.unsubscribe();\n                }\n            }\n            else {\n                this.unsubscribe();\n            }\n        }\n    };\n    SafeSubscriber.prototype.__tryOrUnsub = function (fn, value) {\n        try {\n            fn.call(this._context, value);\n        }\n        catch (err) {\n            this.unsubscribe();\n            throw err;\n        }\n    };\n    SafeSubscriber.prototype.__tryOrSetError = function (parent, fn, value) {\n        try {\n            fn.call(this._context, value);\n        }\n        catch (err) {\n            parent.syncErrorValue = err;\n            parent.syncErrorThrown = true;\n            return true;\n        }\n        return false;\n    };\n    SafeSubscriber.prototype._unsubscribe = function () {\n        var _parentSubscriber = this._parentSubscriber;\n        this._context = null;\n        this._parentSubscriber = null;\n        _parentSubscriber.unsubscribe();\n    };\n    return SafeSubscriber;\n}(Subscriber));\n//# sourceMappingURL=Subscriber.js.map","\"use strict\";\nvar isArray_1 = require('./util/isArray');\nvar isObject_1 = require('./util/isObject');\nvar isFunction_1 = require('./util/isFunction');\nvar tryCatch_1 = require('./util/tryCatch');\nvar errorObject_1 = require('./util/errorObject');\nvar UnsubscriptionError_1 = require('./util/UnsubscriptionError');\n/**\n * Represents a disposable resource, such as the execution of an Observable. A\n * Subscription has one important method, `unsubscribe`, that takes no argument\n * and just disposes the resource held by the subscription.\n *\n * Additionally, subscriptions may be grouped together through the `add()`\n * method, which will attach a child Subscription to the current Subscription.\n * When a Subscription is unsubscribed, all its children (and its grandchildren)\n * will be unsubscribed as well.\n *\n * @class Subscription\n */\nvar Subscription = (function () {\n    /**\n     * @param {function(): void} [unsubscribe] A function describing how to\n     * perform the disposal of resources when the `unsubscribe` method is called.\n     */\n    function Subscription(unsubscribe) {\n        /**\n         * A flag to indicate whether this Subscription has already been unsubscribed.\n         * @type {boolean}\n         */\n        this.closed = false;\n        this._parent = null;\n        this._parents = null;\n        this._subscriptions = null;\n        if (unsubscribe) {\n            this._unsubscribe = unsubscribe;\n        }\n    }\n    /**\n     * Disposes the resources held by the subscription. May, for instance, cancel\n     * an ongoing Observable execution or cancel any other type of work that\n     * started when the Subscription was created.\n     * @return {void}\n     */\n    Subscription.prototype.unsubscribe = function () {\n        var hasErrors = false;\n        var errors;\n        if (this.closed) {\n            return;\n        }\n        var _a = this, _parent = _a._parent, _parents = _a._parents, _unsubscribe = _a._unsubscribe, _subscriptions = _a._subscriptions;\n        this.closed = true;\n        this._parent = null;\n        this._parents = null;\n        // null out _subscriptions first so any child subscriptions that attempt\n        // to remove themselves from this subscription will noop\n        this._subscriptions = null;\n        var index = -1;\n        var len = _parents ? _parents.length : 0;\n        // if this._parent is null, then so is this._parents, and we\n        // don't have to remove ourselves from any parent subscriptions.\n        while (_parent) {\n            _parent.remove(this);\n            // if this._parents is null or index >= len,\n            // then _parent is set to null, and the loop exits\n            _parent = ++index < len && _parents[index] || null;\n        }\n        if (isFunction_1.isFunction(_unsubscribe)) {\n            var trial = tryCatch_1.tryCatch(_unsubscribe).call(this);\n            if (trial === errorObject_1.errorObject) {\n                hasErrors = true;\n                errors = errors || (errorObject_1.errorObject.e instanceof UnsubscriptionError_1.UnsubscriptionError ?\n                    flattenUnsubscriptionErrors(errorObject_1.errorObject.e.errors) : [errorObject_1.errorObject.e]);\n            }\n        }\n        if (isArray_1.isArray(_subscriptions)) {\n            index = -1;\n            len = _subscriptions.length;\n            while (++index < len) {\n                var sub = _subscriptions[index];\n                if (isObject_1.isObject(sub)) {\n                    var trial = tryCatch_1.tryCatch(sub.unsubscribe).call(sub);\n                    if (trial === errorObject_1.errorObject) {\n                        hasErrors = true;\n                        errors = errors || [];\n                        var err = errorObject_1.errorObject.e;\n                        if (err instanceof UnsubscriptionError_1.UnsubscriptionError) {\n                            errors = errors.concat(flattenUnsubscriptionErrors(err.errors));\n                        }\n                        else {\n                            errors.push(err);\n                        }\n                    }\n                }\n            }\n        }\n        if (hasErrors) {\n            throw new UnsubscriptionError_1.UnsubscriptionError(errors);\n        }\n    };\n    /**\n     * Adds a tear down to be called during the unsubscribe() of this\n     * Subscription.\n     *\n     * If the tear down being added is a subscription that is already\n     * unsubscribed, is the same reference `add` is being called on, or is\n     * `Subscription.EMPTY`, it will not be added.\n     *\n     * If this subscription is already in an `closed` state, the passed\n     * tear down logic will be executed immediately.\n     *\n     * @param {TeardownLogic} teardown The additional logic to execute on\n     * teardown.\n     * @return {Subscription} Returns the Subscription used or created to be\n     * added to the inner subscriptions list. This Subscription can be used with\n     * `remove()` to remove the passed teardown logic from the inner subscriptions\n     * list.\n     */\n    Subscription.prototype.add = function (teardown) {\n        if (!teardown || (teardown === Subscription.EMPTY)) {\n            return Subscription.EMPTY;\n        }\n        if (teardown === this) {\n            return this;\n        }\n        var subscription = teardown;\n        switch (typeof teardown) {\n            case 'function':\n                subscription = new Subscription(teardown);\n            case 'object':\n                if (subscription.closed || typeof subscription.unsubscribe !== 'function') {\n                    return subscription;\n                }\n                else if (this.closed) {\n                    subscription.unsubscribe();\n                    return subscription;\n                }\n                else if (typeof subscription._addParent !== 'function' /* quack quack */) {\n                    var tmp = subscription;\n                    subscription = new Subscription();\n                    subscription._subscriptions = [tmp];\n                }\n                break;\n            default:\n                throw new Error('unrecognized teardown ' + teardown + ' added to Subscription.');\n        }\n        var subscriptions = this._subscriptions || (this._subscriptions = []);\n        subscriptions.push(subscription);\n        subscription._addParent(this);\n        return subscription;\n    };\n    /**\n     * Removes a Subscription from the internal list of subscriptions that will\n     * unsubscribe during the unsubscribe process of this Subscription.\n     * @param {Subscription} subscription The subscription to remove.\n     * @return {void}\n     */\n    Subscription.prototype.remove = function (subscription) {\n        var subscriptions = this._subscriptions;\n        if (subscriptions) {\n            var subscriptionIndex = subscriptions.indexOf(subscription);\n            if (subscriptionIndex !== -1) {\n                subscriptions.splice(subscriptionIndex, 1);\n            }\n        }\n    };\n    Subscription.prototype._addParent = function (parent) {\n        var _a = this, _parent = _a._parent, _parents = _a._parents;\n        if (!_parent || _parent === parent) {\n            // If we don't have a parent, or the new parent is the same as the\n            // current parent, then set this._parent to the new parent.\n            this._parent = parent;\n        }\n        else if (!_parents) {\n            // If there's already one parent, but not multiple, allocate an Array to\n            // store the rest of the parent Subscriptions.\n            this._parents = [parent];\n        }\n        else if (_parents.indexOf(parent) === -1) {\n            // Only add the new parent to the _parents list if it's not already there.\n            _parents.push(parent);\n        }\n    };\n    Subscription.EMPTY = (function (empty) {\n        empty.closed = true;\n        return empty;\n    }(new Subscription()));\n    return Subscription;\n}());\nexports.Subscription = Subscription;\nfunction flattenUnsubscriptionErrors(errors) {\n    return errors.reduce(function (errs, err) { return errs.concat((err instanceof UnsubscriptionError_1.UnsubscriptionError) ? err.errors : err); }, []);\n}\n//# sourceMappingURL=Subscription.js.map","\"use strict\";\nvar Observable_1 = require('../../Observable');\nvar do_1 = require('../../operator/do');\nObservable_1.Observable.prototype.do = do_1._do;\nObservable_1.Observable.prototype._do = do_1._do;\n//# sourceMappingURL=do.js.map","\"use strict\";\nvar Observable_1 = require('../../Observable');\nvar map_1 = require('../../operator/map');\nObservable_1.Observable.prototype.map = map_1.map;\n//# sourceMappingURL=map.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Subscriber_1 = require('../Subscriber');\n/* tslint:enable:max-line-length */\n/**\n * Perform a side effect for every emission on the source Observable, but return\n * an Observable that is identical to the source.\n *\n * <span class=\"informal\">Intercepts each emission on the source and runs a\n * function, but returns an output which is identical to the source as long as errors don't occur.</span>\n *\n * <img src=\"./img/do.png\" width=\"100%\">\n *\n * Returns a mirrored Observable of the source Observable, but modified so that\n * the provided Observer is called to perform a side effect for every value,\n * error, and completion emitted by the source. Any errors that are thrown in\n * the aforementioned Observer or handlers are safely sent down the error path\n * of the output Observable.\n *\n * This operator is useful for debugging your Observables for the correct values\n * or performing other side effects.\n *\n * Note: this is different to a `subscribe` on the Observable. If the Observable\n * returned by `do` is not subscribed, the side effects specified by the\n * Observer will never happen. `do` therefore simply spies on existing\n * execution, it does not trigger an execution to happen like `subscribe` does.\n *\n * @example <caption>Map every click to the clientX position of that click, while also logging the click event</caption>\n * var clicks = Rx.Observable.fromEvent(document, 'click');\n * var positions = clicks\n *   .do(ev => console.log(ev))\n *   .map(ev => ev.clientX);\n * positions.subscribe(x => console.log(x));\n *\n * @see {@link map}\n * @see {@link subscribe}\n *\n * @param {Observer|function} [nextOrObserver] A normal Observer object or a\n * callback for `next`.\n * @param {function} [error] Callback for errors in the source.\n * @param {function} [complete] Callback for the completion of the source.\n * @return {Observable} An Observable identical to the source, but runs the\n * specified Observer or callback(s) for each item.\n * @method do\n * @name do\n * @owner Observable\n */\nfunction _do(nextOrObserver, error, complete) {\n    return this.lift(new DoOperator(nextOrObserver, error, complete));\n}\nexports._do = _do;\nvar DoOperator = (function () {\n    function DoOperator(nextOrObserver, error, complete) {\n        this.nextOrObserver = nextOrObserver;\n        this.error = error;\n        this.complete = complete;\n    }\n    DoOperator.prototype.call = function (subscriber, source) {\n        return source.subscribe(new DoSubscriber(subscriber, this.nextOrObserver, this.error, this.complete));\n    };\n    return DoOperator;\n}());\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nvar DoSubscriber = (function (_super) {\n    __extends(DoSubscriber, _super);\n    function DoSubscriber(destination, nextOrObserver, error, complete) {\n        _super.call(this, destination);\n        var safeSubscriber = new Subscriber_1.Subscriber(nextOrObserver, error, complete);\n        safeSubscriber.syncErrorThrowable = true;\n        this.add(safeSubscriber);\n        this.safeSubscriber = safeSubscriber;\n    }\n    DoSubscriber.prototype._next = function (value) {\n        var safeSubscriber = this.safeSubscriber;\n        safeSubscriber.next(value);\n        if (safeSubscriber.syncErrorThrown) {\n            this.destination.error(safeSubscriber.syncErrorValue);\n        }\n        else {\n            this.destination.next(value);\n        }\n    };\n    DoSubscriber.prototype._error = function (err) {\n        var safeSubscriber = this.safeSubscriber;\n        safeSubscriber.error(err);\n        if (safeSubscriber.syncErrorThrown) {\n            this.destination.error(safeSubscriber.syncErrorValue);\n        }\n        else {\n            this.destination.error(err);\n        }\n    };\n    DoSubscriber.prototype._complete = function () {\n        var safeSubscriber = this.safeSubscriber;\n        safeSubscriber.complete();\n        if (safeSubscriber.syncErrorThrown) {\n            this.destination.error(safeSubscriber.syncErrorValue);\n        }\n        else {\n            this.destination.complete();\n        }\n    };\n    return DoSubscriber;\n}(Subscriber_1.Subscriber));\n//# sourceMappingURL=do.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Subscriber_1 = require('../Subscriber');\n/**\n * Applies a given `project` function to each value emitted by the source\n * Observable, and emits the resulting values as an Observable.\n *\n * <span class=\"informal\">Like [Array.prototype.map()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map),\n * it passes each source value through a transformation function to get\n * corresponding output values.</span>\n *\n * <img src=\"./img/map.png\" width=\"100%\">\n *\n * Similar to the well known `Array.prototype.map` function, this operator\n * applies a projection to each value and emits that projection in the output\n * Observable.\n *\n * @example <caption>Map every click to the clientX position of that click</caption>\n * var clicks = Rx.Observable.fromEvent(document, 'click');\n * var positions = clicks.map(ev => ev.clientX);\n * positions.subscribe(x => console.log(x));\n *\n * @see {@link mapTo}\n * @see {@link pluck}\n *\n * @param {function(value: T, index: number): R} project The function to apply\n * to each `value` emitted by the source Observable. The `index` parameter is\n * the number `i` for the i-th emission that has happened since the\n * subscription, starting from the number `0`.\n * @param {any} [thisArg] An optional argument to define what `this` is in the\n * `project` function.\n * @return {Observable<R>} An Observable that emits the values from the source\n * Observable transformed by the given `project` function.\n * @method map\n * @owner Observable\n */\nfunction map(project, thisArg) {\n    if (typeof project !== 'function') {\n        throw new TypeError('argument is not a function. Are you looking for `mapTo()`?');\n    }\n    return this.lift(new MapOperator(project, thisArg));\n}\nexports.map = map;\nvar MapOperator = (function () {\n    function MapOperator(project, thisArg) {\n        this.project = project;\n        this.thisArg = thisArg;\n    }\n    MapOperator.prototype.call = function (subscriber, source) {\n        return source.subscribe(new MapSubscriber(subscriber, this.project, this.thisArg));\n    };\n    return MapOperator;\n}());\nexports.MapOperator = MapOperator;\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nvar MapSubscriber = (function (_super) {\n    __extends(MapSubscriber, _super);\n    function MapSubscriber(destination, project, thisArg) {\n        _super.call(this, destination);\n        this.project = project;\n        this.count = 0;\n        this.thisArg = thisArg || this;\n    }\n    // NOTE: This looks unoptimized, but it's actually purposefully NOT\n    // using try/catch optimizations.\n    MapSubscriber.prototype._next = function (value) {\n        var result;\n        try {\n            result = this.project.call(this.thisArg, value, this.count++);\n        }\n        catch (err) {\n            this.destination.error(err);\n            return;\n        }\n        this.destination.next(result);\n    };\n    return MapSubscriber;\n}(Subscriber_1.Subscriber));\n//# sourceMappingURL=map.js.map","\"use strict\";\nvar root_1 = require('../util/root');\nfunction getSymbolObservable(context) {\n    var $$observable;\n    var Symbol = context.Symbol;\n    if (typeof Symbol === 'function') {\n        if (Symbol.observable) {\n            $$observable = Symbol.observable;\n        }\n        else {\n            $$observable = Symbol('observable');\n            Symbol.observable = $$observable;\n        }\n    }\n    else {\n        $$observable = '@@observable';\n    }\n    return $$observable;\n}\nexports.getSymbolObservable = getSymbolObservable;\nexports.observable = getSymbolObservable(root_1.root);\n/**\n * @deprecated use observable instead\n */\nexports.$$observable = exports.observable;\n//# sourceMappingURL=observable.js.map","\"use strict\";\nvar root_1 = require('../util/root');\nvar Symbol = root_1.root.Symbol;\nexports.rxSubscriber = (typeof Symbol === 'function' && typeof Symbol.for === 'function') ?\n    Symbol.for('rxSubscriber') : '@@rxSubscriber';\n/**\n * @deprecated use rxSubscriber instead\n */\nexports.$$rxSubscriber = exports.rxSubscriber;\n//# sourceMappingURL=rxSubscriber.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\n/**\n * An error thrown when one or more errors have occurred during the\n * `unsubscribe` of a {@link Subscription}.\n */\nvar UnsubscriptionError = (function (_super) {\n    __extends(UnsubscriptionError, _super);\n    function UnsubscriptionError(errors) {\n        _super.call(this);\n        this.errors = errors;\n        var err = Error.call(this, errors ?\n            errors.length + \" errors occurred during unsubscription:\\n  \" + errors.map(function (err, i) { return ((i + 1) + \") \" + err.toString()); }).join('\\n  ') : '');\n        this.name = err.name = 'UnsubscriptionError';\n        this.stack = err.stack;\n        this.message = err.message;\n    }\n    return UnsubscriptionError;\n}(Error));\nexports.UnsubscriptionError = UnsubscriptionError;\n//# sourceMappingURL=UnsubscriptionError.js.map","\"use strict\";\n// typeof any so that it we don't have to cast when comparing a result to the error object\nexports.errorObject = { e: {} };\n//# sourceMappingURL=errorObject.js.map","\"use strict\";\nexports.isArray = Array.isArray || (function (x) { return x && typeof x.length === 'number'; });\n//# sourceMappingURL=isArray.js.map","\"use strict\";\nfunction isFunction(x) {\n    return typeof x === 'function';\n}\nexports.isFunction = isFunction;\n//# sourceMappingURL=isFunction.js.map","\"use strict\";\nfunction isObject(x) {\n    return x != null && typeof x === 'object';\n}\nexports.isObject = isObject;\n//# sourceMappingURL=isObject.js.map","\"use strict\";\n// CommonJS / Node have global context exposed as \"global\" variable.\n// We don't want to include the whole node.d.ts this this compilation unit so we'll just fake\n// the global \"global\" var for now.\nvar __window = typeof window !== 'undefined' && window;\nvar __self = typeof self !== 'undefined' && typeof WorkerGlobalScope !== 'undefined' &&\n    self instanceof WorkerGlobalScope && self;\nvar __global = typeof global !== 'undefined' && global;\nvar _root = __window || __global || __self;\nexports.root = _root;\n// Workaround Closure Compiler restriction: The body of a goog.module cannot use throw.\n// This is needed when used with angular/tsickle which inserts a goog.module statement.\n// Wrap in IIFE\n(function () {\n    if (!_root) {\n        throw new Error('RxJS could not find any global context (window, self, global)');\n    }\n})();\n//# sourceMappingURL=root.js.map","\"use strict\";\nvar Subscriber_1 = require('../Subscriber');\nvar rxSubscriber_1 = require('../symbol/rxSubscriber');\nvar Observer_1 = require('../Observer');\nfunction toSubscriber(nextOrObserver, error, complete) {\n    if (nextOrObserver) {\n        if (nextOrObserver instanceof Subscriber_1.Subscriber) {\n            return nextOrObserver;\n        }\n        if (nextOrObserver[rxSubscriber_1.rxSubscriber]) {\n            return nextOrObserver[rxSubscriber_1.rxSubscriber]();\n        }\n    }\n    if (!nextOrObserver && !error && !complete) {\n        return new Subscriber_1.Subscriber(Observer_1.empty);\n    }\n    return new Subscriber_1.Subscriber(nextOrObserver, error, complete);\n}\nexports.toSubscriber = toSubscriber;\n//# sourceMappingURL=toSubscriber.js.map","\"use strict\";\nvar errorObject_1 = require('./errorObject');\nvar tryCatchTarget;\nfunction tryCatcher() {\n    try {\n        return tryCatchTarget.apply(this, arguments);\n    }\n    catch (e) {\n        errorObject_1.errorObject.e = e;\n        return errorObject_1.errorObject;\n    }\n}\nfunction tryCatch(fn) {\n    tryCatchTarget = fn;\n    return tryCatcher;\n}\nexports.tryCatch = tryCatch;\n;\n//# sourceMappingURL=tryCatch.js.map","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { Observable } from \"rxjs/Observable\";\r\nimport \"rxjs/add/operator/map\";\r\nimport \"rxjs/add/operator/do\";\r\n\r\nexport default class AbstractReader {\r\n    read() {\r\n        return Observable.create(observer => {\r\n            this.onRead(observer);\r\n            return this.onDispose.bind(this);\r\n        });\r\n    }\r\n\r\n    onRead() {\r\n        // override\r\n    }\r\n\r\n    onDispose() {\r\n        // override\r\n    }\r\n}","export function mapRange(x, inStart, inEnd, outStart, outEnd) {\r\n    return outStart + ((outEnd - outStart) / (inEnd - inStart)) * (x - inStart);\r\n}\r\n\r\nexport function getRGB(idata, x, y) {\r\n    const offset = y * (idata.width << 2) + (x << 2);\r\n\r\n    return {\r\n        r: idata.data[offset],\r\n        g: idata.data[offset + 1],\r\n        b: idata.data[offset + 2]\r\n    };\r\n}\r\n\r\nexport function trunc(val) {\r\n    if (val > 255) {\r\n        return 255;\r\n    } else if (val < 0) {\r\n        return 0;\r\n    } else {\r\n        return val;\r\n    }\r\n}\r\n\r\nexport function range(start, end) {\r\n    return Array.from(new Array(end - start + 1).keys()).map(i => i + start);\r\n}\r\nexport function clampByte(v) {\r\n    if (v > 255) {\r\n        return 255;\r\n    } else if (v < 0) {\r\n        return 0;\r\n    }\r\n    return v;\r\n}","import { clampByte } from \"../utils\";\r\n\r\nexport default {\r\n    mul(color, v) {\r\n        color.r = ~~(color.r * v);\r\n        color.g = ~~(color.g * v);\r\n        color.b = ~~(color.b * v);\r\n\r\n        return this;\r\n    },\r\n\r\n    add(color, v) {\r\n        color.r += v;\r\n        color.g += v;\r\n        color.b += v;\r\n\r\n        return this;\r\n    },\r\n\r\n    addc(color, { r, g, b }) {\r\n        color.r += r;\r\n        color.g += g;\r\n        color.b += b;\r\n\r\n        return this;\r\n    },\r\n\r\n    div(color, v) {\r\n        return this.mul(color, 1.0 / v);\r\n    },\r\n\r\n    inverse(color) {\r\n        color.r = 255 - color.r;\r\n        color.g = 255 - color.g;\r\n        color.b = 255 - color.b;\r\n\r\n        return this;\r\n    },\r\n\r\n    getGrayscale(color) {\r\n        return ~~((color.r + color.g + color.b) / 3);\r\n    },\r\n\r\n    desaturate(color) {\r\n        color.r = color.g = color.b = this.getGrayscale(color);\r\n\r\n        return this;\r\n    },\r\n\r\n    clamp(color) {\r\n        color.r = clampByte(color.r);\r\n        color.g = clampByte(color.g);\r\n        color.b = clampByte(color.b);\r\n\r\n        return this;\r\n    }\r\n};\r\n","import rgbProcessor from \"./rgbProcessor\";\r\n\r\nexport default class AAImage {\r\n\r\n    constructor({ width, height, colorProcessor, data = [], meta = {} } = {}) {\r\n        this.width = width;\r\n        this.height = height;\r\n        this.data = data;\r\n        this.meta = meta;\r\n        this.colorProcessor = colorProcessor;\r\n    }\r\n\r\n    getAt(x, y) {\r\n        return this.data[x + this.width * y];\r\n    }\r\n\r\n    process(fn) {\r\n        this.data.forEach(pt => {\r\n            fn(pt, this.colorProcessor);\r\n        });\r\n\r\n        return this;\r\n    }\r\n\r\n    toImageData() {\r\n        const data = [];\r\n        let color;\r\n\r\n        for (let i = 0; i < this.data.length; i++) {\r\n            color = this.data[i];\r\n\r\n            data[data.length] = color.r;\r\n            data[data.length] = color.g;\r\n            data[data.length] = color.b;\r\n            data[data.length] = 255;\r\n        }\r\n\r\n        return new ImageData(\r\n            new Uint8ClampedArray(data),\r\n            this.width,\r\n            this.height\r\n        );\r\n    }\r\n\r\n    static fromImageData(idata) {\r\n        const data32 = new Uint32Array(idata.data.buffer);\r\n        const length = data32.length;\r\n        const data = new Array(length);\r\n\r\n        let i = length;\r\n        let pixel32;\r\n\r\n        while (i--) {\r\n            pixel32 = data32[i];\r\n\r\n            data[i] = {\r\n                r: pixel32 & 0xff,\r\n                g: (pixel32 >> 8) & 0xff,\r\n                b: (pixel32 >> 16) & 0xff\r\n            };\r\n        }\r\n\r\n        return new AAImage({\r\n            data,\r\n            width: idata.width,\r\n            height: idata.height,\r\n            colorProcessor: rgbProcessor\r\n        });\r\n    }\r\n\r\n    static fromHTMLImageElement(image) {\r\n        const canvas = document.createElement(\"canvas\");\r\n        const ctx = canvas.getContext(\"2d\");\r\n        const { naturalWidth, naturalHeight } = image;\r\n\r\n        canvas.width = naturalWidth;\r\n        canvas.height = naturalHeight;\r\n        ctx.drawImage(image, 0, 0);\r\n\r\n        return AAImage.fromImageData(\r\n            ctx.getImageData(0, 0, naturalWidth, naturalHeight)\r\n        );\r\n    }\r\n}","import AbstractReader from \"./AbstractReader\";\r\nimport AAImage from \"../core/AAImage\";\r\n\r\nexport default class ImageReader extends AbstractReader {\r\n\r\n    constructor(url) {\r\n        super();\r\n        this.url = url;\r\n    }\r\n\r\n    onRead(observer) {\r\n        const img = document.createElement(\"img\");\r\n        img.crossOrigin = \"Anonymous\";\r\n\r\n        const onLoad = () => {\r\n            removeListeners();\r\n            observer.next(AAImage.fromHTMLImageElement(img));\r\n            observer.complete();\r\n        };\r\n\r\n        const onError = (e) => {\r\n            removeListeners();\r\n            observer.error(e);\r\n        };\r\n\r\n        const removeListeners = () => {\r\n            img.removeEventListener(\"load\", onLoad);\r\n            img.removeEventListener(\"error\", onError);\r\n        };\r\n\r\n        img.addEventListener(\"load\", onLoad);\r\n        img.addEventListener(\"error\", onError);\r\n\r\n        if (img.complete && img.naturalWidth) {\r\n            onLoad();\r\n        } else if (this.url) {\r\n            img.src = this.url;\r\n        }\r\n    }\r\n\r\n    static fromURL(url) {\r\n        const reader = new ImageReader(url);\r\n        return reader.read();\r\n    }\r\n\r\n    static fromHTMLImage(img) {\r\n        return ImageReader.fromURL(img.src);\r\n    }\r\n}\r\n","import AbstractReader from \"./AbstractReader\";\r\nimport AAImage from \"../core/AAImage\";\r\n\r\nexport default class VideoReader extends AbstractReader {\r\n    constructor(video, captureFrame, options) {\r\n        super();\r\n        this.video = video;\r\n        this.options = Object.assign({}, { autoplay: false }, options);\r\n        this.video.autoplay = this.options.autoplay;\r\n\r\n        this.captureFrame = captureFrame;\r\n    }\r\n\r\n    createVideoElement(url) {\r\n        const video = document.createElement('video');\r\n        video.src = url;\r\n        video.crossOrigin = 'anonymous';\r\n        video.controls = true; // Optional: Adds video controls for debugging\r\n        document.body.appendChild(video); // Optional: Appends video to the DOM for visibility\r\n        return video;\r\n    }\r\n\r\n    onRead(observer) {\r\n        const video = this.video;\r\n\r\n        this.playbackLoop = () => {\r\n            if (video.paused || video.ended) {\r\n                return;\r\n            }\r\n\r\n            observer.next(AAImage.fromImageData(this.captureFrame(video)));\r\n\r\n            requestAnimationFrame(this.playbackLoop);\r\n        };\r\n\r\n        this.onError = () => {\r\n            const { src, error: { code, message } } = video;\r\n\r\n            video.removeEventListener(\"play\", this.playbackLoop);\r\n            observer.error(`Error occurred while trying to play ${src}: ${code}, ${message}`);\r\n        };\r\n\r\n        video.addEventListener(\"error\", this.onError);\r\n        video.addEventListener(\"play\", this.playbackLoop);\r\n\r\n        if (this.options.autoplay) {\r\n            video.play();\r\n        }\r\n    }\r\n\r\n    onDispose() {\r\n        this.video.removeEventListener(\"play\", this.playbackLoop);\r\n        this.video.removeEventListener(\"error\", this.onError);\r\n        if (this.video.parentNode) {\r\n            this.video.parentNode.removeChild(this.video); // Remove video element from DOM\r\n        }\r\n    }\r\n\r\n    static fromVideoElement(video, options) {\r\n        console.log(\"read from video element\");\r\n        const reader = new VideoReader(video, createVideoCapture(), options);\r\n        return reader.read();\r\n\r\n    }\r\n\r\n    static fromURL(url, options) {\r\n        console.log(`read from url ${url}`);\r\n        const reader = new VideoReader(url, createVideoCapture(), options);\r\n        return reader.read();\r\n\r\n    }\r\n}\r\n\r\nfunction createVideoCapture() {\r\n    const canvas = document.createElement(\"canvas\");\r\n    const ctx = canvas.getContext(\"2d\");\r\n\r\n    return function capture(video) {\r\n        const w = video.videoWidth;\r\n        const h = video.videoHeight;\r\n\r\n        canvas.width = w;\r\n        canvas.height = h;\r\n\r\n        ctx.drawImage(video, 0, 0, w, h);\r\n\r\n        return ctx.getImageData(0, 0, w, h);\r\n    };\r\n}\r\n","import AbstractReader from \"./AbstractReader\";\r\nimport AAImage from \"../core/AAImage\";\r\n\r\nexport default class ImageDataReader extends AbstractReader {\r\n\r\n    constructor(idata) {\r\n        super();\r\n        this.idata = idata;\r\n    }\r\n\r\n    onRead(observer) {\r\n        observer.next(AAImage.fromImageData(this.idata));\r\n        observer.complete();\r\n    }\r\n\r\n    static fromImageData(idata) {\r\n        const reader = new ImageDataReader(idata);\r\n        return reader.read();\r\n    }\r\n\r\n    static fromCanvas(canvas, x, y, width, height) {\r\n        const ctx = canvas.getContext(\"2d\");\r\n        const idata = ctx.getImageData(\r\n            x || 0,\r\n            y || 0,\r\n            width || canvas.width,\r\n            height || canvas.height\r\n        );\r\n\r\n        return ImageDataReader.fromImageData(idata);\r\n    }\r\n}\r\n","export default function factory(alpha, beta) {\r\n    return image => linearTransformation(image, alpha, beta);\r\n}\r\n\r\nexport function linearTransformation(image, alpha, beta) {\r\n    return image.process((color, processor) => {\r\n        processor.mul(color, alpha).add(color, beta).clamp(color);\r\n    });\r\n}\r\n","import { mapRange } from \"./utils\";\r\n\r\nexport default function aafont(charset, options) {\r\n    const table = new Array(charset.length);\r\n    let min = 255;\r\n    let max = 0;\r\n\r\n    for (let i = 0; i < charset.length; i++) {\r\n        const char = charset[i];\r\n        const brightness = calculateBrightness(char, options);\r\n\r\n        if (brightness < min) {\r\n            min = brightness;\r\n        }\r\n        if (brightness > max) {\r\n            max = brightness;\r\n        }\r\n\r\n        table[i] = { char, brightness };\r\n    }\r\n\r\n    return table\r\n        .map(({ char, brightness }) => ({ char, brightness: ~~mapRange(brightness, min, max, 0, 255) }))\r\n        .sort((a, b) => {\r\n            if (a.brightness < b.brightness) return -1;\r\n            if (a.brightness > b.brightness) return 1;\r\n            return 0;\r\n        });\r\n}\r\n\r\nfunction calculateBrightness(char, options) {\r\n    const canvas = drawChar(char, options);\r\n    const ctx = canvas.getContext(\"2d\");\r\n    const idata = ctx.getImageData(0, 0, canvas.width, canvas.height);\r\n    const data32 = new Uint32Array(idata.data.buffer);\r\n\r\n    let brightness = 0;\r\n    let i = data32.length;\r\n    let r, g, b, pixel32;\r\n\r\n    while (i--) {\r\n        pixel32 = data32[i];\r\n\r\n        r = pixel32 & 0xff;\r\n        g = (pixel32 >> 8) & 0xff;\r\n        b = (pixel32 >> 16) & 0xff;\r\n\r\n        brightness += (r + g + b) / 3;\r\n    }\r\n\r\n    brightness /= canvas.width * canvas.height;\r\n\r\n    return brightness;\r\n}\r\n\r\nfunction drawChar(char, { fontFamily = \"monospace\" } = {}) {\r\n    const { canvas, ctx } = createCanvas();\r\n\r\n    ctx.fillStyle = \"#fff\";\r\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n    ctx.fillStyle = \"#000\";\r\n    ctx.textBaseline = \"top\";\r\n    ctx.textAlign = \"left\";\r\n    ctx.font = \"20px \" + fontFamily;\r\n\r\n    ctx.fillText(char, 0, 0);\r\n\r\n    return canvas;\r\n}\r\n\r\nconst createCanvas = once(() => {\r\n    const canvas = document.createElement(\"canvas\");\r\n    const ctx = canvas.getContext(\"2d\", { alpha: false });\r\n\r\n    canvas.width = 15;\r\n    canvas.height = 25;\r\n\r\n    return { canvas, ctx };\r\n});\r\n\r\nfunction once(func) {\r\n    func._result = null;\r\n    return () => func._result || (func._result = func());\r\n}","import { range } from \"../utils\";\r\nimport aafont from \"../aafont\";\r\n\r\nexport default class BaseRenderer {\r\n    constructor(options) {\r\n        this.options = Object.assign({}, {\r\n            charset: ASCII_CHARSET,\r\n            fontFamily: \"monospace\"\r\n        }, options);\r\n\r\n        this.fontmap = BaseRenderer.buildFont(this.options.charset, {\r\n            fontFamily: this.options.fontFamily\r\n        });\r\n\r\n        this.matchChar = memoize(this.matchChar.bind(this));\r\n    }\r\n\r\n    render(image) {\r\n        return this.processImage(image);\r\n    }\r\n\r\n    processImage(image) {\r\n        let i = image.data.length;\r\n        let pixel;\r\n\r\n        while (i--) {\r\n            pixel = image.data[i];\r\n            pixel.char = this.matchChar(pixel.mono);\r\n        }\r\n\r\n        return image;\r\n    }\r\n\r\n    matchChar(monoValue) {\r\n        let match = { brightness: -1 };\r\n\r\n        for (let i = 0; i < this.fontmap.length; i++) {\r\n            const tuple = this.fontmap[i];\r\n\r\n            if (Math.abs(monoValue - tuple.brightness) <= Math.abs(monoValue - match.brightness)) {\r\n                match = tuple;\r\n            } else {\r\n                return match.char;\r\n            }\r\n        }\r\n\r\n        return match.char;\r\n    }\r\n\r\n    static buildFont(charset, options) {\r\n        return aafont(charset, options);\r\n    }\r\n}\r\n\r\nexport const ASCII_CHARSET = range(32, 126).map(code => String.fromCharCode(code));\r\nexport const SIMPLE_CHARSET = [\".\", \":\", \"*\", \"I\", \"$\", \"V\", \"F\", \"N\", \"M\"];\r\n\r\nfunction memoize(func) {\r\n    func._cache = [];\r\n    return (arg) => func._cache[arg] || (func._cache[arg] = func(arg));\r\n}","import BaseRenderer from \"./BaseRenderer\";\r\n\r\nexport { ASCII_CHARSET, SIMPLE_CHARSET } from \"./BaseRenderer\";\r\n\r\nexport default function factory(options) {\r\n    const renderer = new HTMLRenderer(options);\r\n\r\n    return data => renderer.render(data);\r\n}\r\n\r\nexport class HTMLRenderer extends BaseRenderer {\r\n\r\n    constructor(options) {\r\n        super(Object.assign({}, {\r\n            tagName: \"pre\",\r\n            fontSize: 7,\r\n            background: \"#fff\",\r\n            color: \"#000\"\r\n                }, options));\r\n\r\n        this.el = this.options.el || document.createElement(this.options.tagName);\r\n        this.el.style.fontSize = this.options.fontSize + \"px\";\r\n        this.el.style.fontFamily = this.options.fontFamily;\r\n        this.el.style.backgroundColor = this.options.background;\r\n        this.el.style.color = this.options.color;\r\n\r\n        // if (this.options.gradient) {\r\n        //     this.createGradient();\r\n        // } else {\r\n        //     this.el.style.backgroundColor = this.options.background;\r\n        // }\r\n    }\r\n    render(image) {\r\n        super.render(image);\r\n        // this.el.style.color = this.gradient;\r\n\r\n        // if (!image.meta.colored) {\r\n        //     this.el.style.color = this.options.color;\r\n        // }\r\n        const renderer = monoRenderer(this.el);\r\n\r\n        // const renderer =  image.meta.colored\r\n        //     ? colorRenderer(this.el)\r\n        //     : monoRenderer(this.el);\r\n            // when it is not colored, it is mono \r\n        return renderer(image);\r\n    }\r\n\r\n    createGradient(){\r\n        const gradient = this.options.gradient.map((color, index) => {\r\n            return `${color} ${(index / (this.options.gradient.length - 1)) * 100}%`;\r\n        }).join(', ');\r\n    \r\n        this.gradient = gradient;\r\n\r\n        // this.el.style.color = `linear-gradient(0deg, ${gradientStops})`;\r\n        console.log(\"color in create gradient is \",gradient);\r\n    \r\n        // const gradient = this.ctx.createLinearGradient(0, 0, this.el.width, this.el.height);\r\n        // this.options.gradient.forEach((color, index) => {\r\n        //     gradient.addColorStop(index / (this.options.gradient.length - 1), color);\r\n        // });\r\n        // this.gradient = gradient;\r\n        // console.log(\"create gradient in HTML RENDERER \",gradient);\r\n\r\n    }\r\n}\r\n\r\nfunction colorRenderer(el) {\r\n    const wrapInColor = ({ char, r, g, b , a }) => (\r\n        `<span style=\"color: rgba(${ r }, ${ g }, ${ b }, ${ a })\">${ char }</span>`\r\n    );\r\n\r\n    const toString = stringRenderer(wrapInColor);\r\n\r\n    return image => {\r\n        el.innerHTML = toString(image);\r\n        return el;\r\n    };\r\n}\r\n\r\nfunction monoRenderer(el) {\r\n    const toString = stringRenderer(({ char }) => char);\r\n\r\n    return image => {\r\n        el.textContent = toString(image);\r\n        return el;\r\n    };\r\n}\r\n\r\nfunction stringRenderer(renderPixel) {\r\n    return ({ width, data }) => {\r\n        let str = \"\";\r\n        let w = width;\r\n\r\n        for (let i = 0, length = data.length; i < length; i++, w--) {\r\n            if (w === 0) {\r\n                str += \"\\n\";\r\n                w = width;\r\n            }\r\n\r\n            str += renderPixel(data[i]);\r\n        }\r\n\r\n        return str;\r\n    };\r\n}","import BaseRenderer from \"./BaseRenderer\";\r\n\r\nexport { ASCII_CHARSET, SIMPLE_CHARSET } from \"./BaseRenderer\";\r\n\r\nexport default function factory(options) {\r\n    const renderer = new CanvasRenderer(options);\r\n    return image => renderer.render(image);\r\n}\r\n\r\nexport class CanvasRenderer extends BaseRenderer {\r\n\r\n    constructor(options) {\r\n        super(Object.assign({}, {\r\n            fontSize: 7,\r\n            lineHeight: 7,\r\n            charWidth: 4.2,\r\n            width: 400,\r\n            height: 300,\r\n            background: \"#fff\",\r\n            color: \"#000\",\r\n            gradient: null // Adding gradient option\r\n        }, options));\r\n\r\n        this.el = this.options.el || document.createElement(\"canvas\");\r\n        this.el.width = this.options.width;\r\n        this.el.height = this.options.height;\r\n\r\n        this.ctx = this.el.getContext(\"2d\");\r\n        this.ctx.textBaseline = \"top\";\r\n        this.ctx.textAlign = \"start\";\r\n        this.ctx.font = this.options.fontSize + \"px \" + this.options.fontFamily;\r\n\r\n        if (this.options.gradient) {\r\n            this.createGradientStop();\r\n            // this.createGradient();\r\n        } else {\r\n            this.el.style.backgroundColor = this.options.background;\r\n        }\r\n    }\r\n\r\n    createGradient() {\r\n        const gradient = this.ctx.createLinearGradient(0, 0, this.el.width, this.el.height);\r\n        this.options.gradient.forEach((index,color) => {\r\n            gradient.addColorStop(index / (this.options.gradient.length - 1), color);\r\n        });\r\n        this.gradient = gradient;\r\n    }\r\n\r\n    createGradientStop() {\r\n        const gradient = this.ctx.createLinearGradient(0, 0, this.el.width, this.el.height);\r\n        this.options.gradient.forEach((position,color) => {\r\n            gradient.addColorStop(position, color);\r\n        });\r\n        this.gradient = gradient;\r\n    }\r\n\r\n    render(image) {\r\n        super.render(image);\r\n\r\n        this.clearCanvas();\r\n\r\n        const renderer = image.meta.colored\r\n            ? colorRenderer(this.ctx, this.options)\r\n            : monoRenderer(this.ctx, this.options);\r\n\r\n        renderer(image);\r\n\r\n        return this.el;\r\n    }\r\n\r\n    clearCanvas() {\r\n        if (this.gradient) {\r\n            this.ctx.fillStyle = this.gradient;\r\n        } else {\r\n            this.ctx.fillStyle = this.options.background;\r\n        }\r\n        this.ctx.fillRect(0, 0, this.el.width, this.el.height);\r\n    }\r\n}\r\n\r\nfunction colorRenderer(ctx, options) {\r\n    return ({ data, width }) => {\r\n        const { charWidth, lineHeight } = options;\r\n        let x;\r\n        let y;\r\n        let color;\r\n\r\n        let i = data.length;\r\n        while (i--) {\r\n            x = i % width;\r\n            y = ~~(i / width);\r\n            color = data[i];\r\n\r\n            ctx.fillStyle = `rgb(${ color.r }, ${ color.g }, ${ color.b })`;\r\n            ctx.fillText(data[i].char, x * charWidth, y * lineHeight);\r\n        }\r\n    };\r\n}\r\n\r\nfunction monoRenderer(ctx, options) {\r\n    return ({ data, width }) => {\r\n        const lineHeight = options.lineHeight;\r\n        let y;\r\n        let line = \"\";\r\n\r\n        ctx.fillStyle = options.color;\r\n\r\n        for (let i = 0, length = data.length; i < length; i += width) {\r\n            y = ~~(i / width);\r\n            line = \"\";\r\n\r\n            for (let j = i; j < i + width; j++) {\r\n                line += data[j].char;\r\n            }\r\n\r\n            ctx.fillText(line, 0, y * lineHeight);\r\n        }\r\n    };\r\n}\r\n","import { clampByte } from \"../utils\";\r\n\r\nexport default {\r\n    mul(color, v) {\r\n        color.mono = ~~(color.mono * v);\r\n        return this;\r\n    },\r\n\r\n    add(color, v) {\r\n        color.mono += v;\r\n        return this;\r\n    },\r\n\r\n    div(color, v) {\r\n        this.mul(color, 1.0 / v);\r\n    },\r\n\r\n    inverse(color) {\r\n        color.mono = 255 - color.mono;\r\n        return this;\r\n    },\r\n\r\n    desaturate(color) {\r\n        color.r = color.g = color.b = color.mono;\r\n        return color;\r\n    },\r\n\r\n    clamp(color) {\r\n        color.mono = clampByte(color.mono);\r\n        return this;\r\n    }\r\n};","import AAImage from \"./core/AAImage\";\r\nimport monoProcessor from \"./core/monoProcessor\";\r\nimport rgbProcessor from \"./core/rgbProcessor\";\r\nimport { mapRange } from \"./utils\";\r\n\r\nexport default function factory(options) {\r\n    return (image) => aa(image, options);\r\n}\r\n\r\nexport function aa(image, options) {\r\n    const { width, height, colored = false } = options;\r\n\r\n    const bw = image.width / width;\r\n    const bh = image.height / height;\r\n\r\n    let minMono = 255;\r\n    let maxMono = 0;\r\n\r\n    const data = new Array(width * height);\r\n    let k = 0;\r\n\r\n    for (let i = 0; i < height; i++) {\r\n        for (let j = 0; j < width; j++) {\r\n            const color = analyzeColors(\r\n                image,\r\n                ~~(j * bw),\r\n                ~~(i * bh),\r\n                bw,\r\n                bh\r\n            );\r\n\r\n            if (color.mono > maxMono) {\r\n                maxMono = color.mono;\r\n            }\r\n            if (color.mono < minMono) {\r\n                minMono = color.mono;\r\n            }\r\n\r\n            data[k++] = color;\r\n        }\r\n    }\r\n\r\n    const aaImage = new AAImage({\r\n        width,\r\n        height,\r\n        data,\r\n        colorProcessor: monoProcessor,\r\n        meta: { colored }\r\n    });\r\n    \r\n    normalizeGrayscale(aaImage, minMono, maxMono);\r\n\r\n    return aaImage;\r\n}\r\n\r\nfunction analyzeColors(image, x, y, width, height) {\r\n    const avgColor = { r: 0, g: 0, b: 0 };\r\n    let count = 0;\r\n\r\n    for (let row = 0; row < height; row++) {\r\n        for (let col = 0; col < width; col++) {\r\n            rgbProcessor.addc(avgColor, image.getAt(x + col, y + row));\r\n            count++;\r\n        }\r\n    }\r\n\r\n    rgbProcessor.div(avgColor, count);\r\n\r\n    return {\r\n        r: avgColor.r,\r\n        g: avgColor.g,\r\n        b: avgColor.b,\r\n        mono: rgbProcessor.getGrayscale(avgColor)\r\n    };\r\n}\r\n\r\nfunction normalizeGrayscale(img, a, b) {\r\n    img.process((color) => {\r\n        color.mono = ~~mapRange(color.mono, a, b, 0, 255);\r\n    });\r\n}","import ImageReader from \"./readers/ImageReader\";\r\nimport VideoReader from \"./readers/VideoReader\";\r\nimport ImageDataReader from \"./readers/ImageDataReader\";\r\n\r\nimport linear from \"./filters/linear\";\r\nimport brightness from \"./filters/brightness\";\r\nimport contrast from \"./filters/contrast\";\r\nimport inverse from \"./filters/inverse\";\r\nimport desaturate from \"./filters/desaturate\";\r\n\r\nimport html from \"./renderers/HTMLRenderer\";\r\nimport canvas from \"./renderers/CanvasRenderer\";\r\nimport { SIMPLE_CHARSET, ASCII_CHARSET } from \"./renderers/BaseRenderer\";\r\n\r\nimport aa from \"./aa\";\r\n\r\nexport { aa };\r\n\r\nexport const read = {\r\n    image: {\r\n        fromHTMLImage: ImageReader.fromHTMLImage,\r\n        fromURL: ImageReader.fromURL\r\n    },\r\n\r\n    imageData: {\r\n        fromImageData: ImageDataReader.fromImageData,\r\n        fromCanvas: ImageDataReader.fromCanvas\r\n    },\r\n\r\n    video: {\r\n        fromVideoElement: VideoReader.fromVideoElement\r\n    }\r\n};\r\n\r\nexport const filter = {\r\n    linear,\r\n    brightness,\r\n    contrast,\r\n    inverse,\r\n    desaturate\r\n};\r\n\r\nexport const render = {\r\n    html,\r\n    canvas\r\n};\r\n\r\nexport const charset = {\r\n    SIMPLE_CHARSET,\r\n    ASCII_CHARSET\r\n};\r\n\r\nexport default {\r\n    aa,\r\n    read,\r\n    filter,\r\n    render,\r\n    charset\r\n};","import linear from \"./linear\";\r\n\r\nexport default function factory(val) {\r\n    return function (image) {\r\n        return brightness(image, val);\r\n    };\r\n}\r\n\r\nexport function brightness(image, val) {\r\n    return linear(1, val || 0)(image);\r\n}\r\n","import { linearTransformation } from \"./linear\";\r\n\r\nexport default function factory(val) {\r\n    return image => contrast(image, val);\r\n}\r\n\r\nexport function contrast(image, val = 1) {\r\n    return linearTransformation(image, val, 0);\r\n}\r\n","export default function factory() {\r\n    return image => inverse(image);\r\n}\r\n\r\nexport function inverse(image) {\r\n    return image.process((color, processor) => {\r\n        processor.inverse(color).clamp(color);\r\n    });\r\n}\r\n","export default function factory() {\r\n    return image => desaturate(image);\r\n}\r\n\r\nexport function desaturate(image) {\r\n    return image.process((color, processor) => {\r\n        processor.desaturate(color);\r\n    });\r\n}\r\n"],"names":["root","factory","exports","module","define","amd","self","root_1","toSubscriber_1","observable_1","Observable","subscribe","this","_isScalar","_subscribe","prototype","lift","operator","observable","source","observerOrNext","error","complete","sink","toSubscriber","call","add","_trySubscribe","syncErrorThrowable","syncErrorThrown","syncErrorValue","err","forEach","next","PromiseCtor","_this","Rx","config","Promise","Error","resolve","reject","subscription","value","unsubscribe","subscriber","create","empty","closed","__extends","d","b","p","hasOwnProperty","__","constructor","Object","isFunction_1","Subscription_1","Observer_1","rxSubscriber_1","Subscriber","_super","destinationOrNext","isStopped","arguments","length","destination","SafeSubscriber","rxSubscriber","_next","_error","_complete","_unsubscribeAndRecycle","_parent","_parents","Subscription","_parentSubscriber","context","isFunction","bind","_context","__tryOrSetError","__tryOrUnsub","wrappedComplete","fn","parent","_unsubscribe","isArray_1","isObject_1","tryCatch_1","errorObject_1","UnsubscriptionError_1","_subscriptions","errors","hasErrors","_a","index","len","remove","tryCatch","errorObject","e","UnsubscriptionError","flattenUnsubscriptionErrors","isArray","sub","isObject","concat","push","teardown","EMPTY","_addParent","tmp","subscriptions","subscriptionIndex","indexOf","splice","reduce","errs","Observable_1","do_1","do","_do","map_1","map","Subscriber_1","nextOrObserver","DoOperator","DoSubscriber","safeSubscriber","project","thisArg","TypeError","MapOperator","MapSubscriber","count","result","getSymbolObservable","$$observable","Symbol","for","$$rxSubscriber","i","toString","join","name","stack","message","Array","x","__window","window","__self","WorkerGlobalScope","__global","g","_root","tryCatchTarget","tryCatcher","apply","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","definition","key","o","defineProperty","enumerable","get","globalThis","Function","obj","prop","r","toStringTag","AbstractReader","_classCallCheck","observer","onRead","onDispose","mapRange","inStart","inEnd","outStart","outEnd","clampByte","v","mul","color","addc","_ref","div","inverse","getGrayscale","desaturate","clamp","AAImage","width","height","colorProcessor","_ref$data","data","_ref$meta","meta","idata","pixel32","data32","Uint32Array","buffer","rgbProcessor","image","canvas","document","createElement","ctx","getContext","naturalWidth","naturalHeight","drawImage","fromImageData","getImageData","y","pt","ImageData","Uint8ClampedArray","ImageReader","_AbstractReader","url","_callSuper","_inherits","img","crossOrigin","onLoad","removeListeners","fromHTMLImageElement","onError","removeEventListener","addEventListener","src","read","fromURL","VideoReader","video","captureFrame","options","assign","autoplay","controls","body","appendChild","_this2","playbackLoop","paused","ended","requestAnimationFrame","_video$error","code","play","parentNode","removeChild","console","log","createVideoCapture","w","videoWidth","h","videoHeight","ImageDataReader","alpha","beta","linearTransformation","process","processor","calculateBrightness","char","_ref2","_ref2$fontFamily","fontFamily","_createCanvas","createCanvas","fillStyle","fillRect","textBaseline","textAlign","font","fillText","drawChar","brightness","func","_result","start","end","BaseRenderer","charset","ASCII_CHARSET","fontmap","buildFont","matchChar","_cache","arg","memoize","table","min","max","sort","a","aafont","processImage","pixel","mono","monoValue","match","tuple","Math","abs","from","keys","String","fromCharCode","HTMLRenderer","_BaseRenderer","tagName","fontSize","background","el","style","backgroundColor","_get","_getPrototypeOf","renderer","stringRenderer","textContent","gradient","renderPixel","_ref3","str","CanvasRenderer","lineHeight","charWidth","createGradientStop","createLinearGradient","addColorStop","position","clearCanvas","colored","line","j","monoRenderer","_options$colored","bw","bh","minMono","maxMono","k","analyzeColors","aaImage","monoProcessor","normalizeGrayscale","aa","avgColor","row","col","getAt","fromHTMLImage","imageData","fromCanvas","fromVideoElement","filter","linear","val","contrast","render","html","SIMPLE_CHARSET"],"sourceRoot":""}